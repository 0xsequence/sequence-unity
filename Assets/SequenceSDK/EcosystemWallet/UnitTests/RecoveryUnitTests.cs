using System.Linq;
using Newtonsoft.Json;
using NUnit.Framework;
using Sequence.EcosystemWallet.Primitives;
using Sequence.Utils;
using UnityEngine;

namespace Sequence.EcosystemWallet.UnitTests
{
    public class RecoveryUnitTests
    {
        [TestCase("signer:0x18Db753Bcfb28DA9770e68723E0f1BFF3EaaF702:81750:3 signer:0x1B79c5D8c4364F17a42a4808E005a93526C5084F:2:1334030 signer:0x87A214F76E76E790c1a3Bb55e4d83b966f9b6C57:117061:4 signer:0xa4698d8b96c425bA4F4DB22009efeEDad4F533b7:21614:3388985866667 signer:0x1f1567f8F883B9aFC5Fe2042d1cCbc0CD804E06e:14:129185 signer:0x80DFb85E00EeFa9E94F827c639e0F197b8a54484:2673:1987802219133 signer:0xb6F0BFcD66bA5f6d03cEF09c02C4cD9F4C2B4030:7622:154089013038758 signer:0x4990631CEC6C6a91223F13Baec7a8A15E4aB25b5:16777214:113046 signer:0xc1C3667D8433751af8c37Ec55EbbE3C66FFC9E9b:836577:10397822422092821802 signer:0xDC08F41986254CC1BEE39594c91DB28D58dc0976:17:49674592821651760 signer:0x8A8D83521dBdaAD5252866Be4085bacBF29FB7C1:43507:38 signer:0x74B25324694e153295d0020060B85Ea8a38aD47c:4105:169383570070322 signer:0x8bdEABad5C95901A737e34C8EA057dE8Ff90ff5A:204528:2 signer:0xc10cFb30B283B2C3D6FA1D766de8E3418892dd84:25688:4453062132022 signer:0xf4416720ADec991E761c768C3072ae82139B625B:16777213:512670769084247277 signer:0x5455b49CD4729A8d29aE6C35Cd11B7E82dc44088:57728:842752444 signer:0xc8a6928fb18BA18d761b00dBD5d99A596011d5c4:1728823:9416 signer:0xd2E138A1e3c523f749fb9708456931B72D286654:10:3 signer:0x23eAFCC058BAF31cAB5Fc1083D45327359208145:33:182109991148523181 signer:0x79A772a818146976bFCbA31bA29DCB9d3F0dF63d:16777212:7905209 signer:0xf61FEda3A01407B7ca136B86972a29355B67AF6f:10:1 signer:0xBF25c8B70921d4C187BA459F33A6e060A7D80398:110905:3 signer:0xBadCe3B51Bc3b7946d22756e6A38b592b57bf912:1:6843247845 signer:0x96457c5d60045aBEc807C18322eb61003de67d83:2288611:427539 signer:0x84F85450E95a28827db86C208Cc9A4aef335eb66:5410:88 signer:0x1e2E90Bf24B495a83F36e6e8dFE39f08D08bb172:3:18100202 signer:0xeeaBE54c8c29A818B8fdd392AD561A24568A8fe5:1240:154 signer:0xC2D3458F82CC2B49234550B11B1aDC87aFdEafFE:2:18446744073709551612 signer:0x9251CE3957e3E3C923D88ff7178F8cEb84931119:16777215:45501204049731617 signer:0xc5d1d771381A73Bca7A13d31E65E588bb6cC0F97:450:1 signer:0xFA0bDd2A362389F7d5b69c6B732e1C3de5E62cB4:107700:7040832 signer:0xFBd4c7C4F31f751b2a300A4F1F8a83b376CB7d99:166354:0 signer:0x1DFcC45DC944E5ad43797c2d5Ce8084B8bBBD6aA:1757:76058 signer:0x9aD430856B50b503C16480f65329B94A83153768:279924:179621497 signer:0xE3536a43EA631803314F7A28C3A26fB7E23261a7:4052:0 signer:0x60C1D455BB514197315693469245B67dC27A867f:161:1829432574588 signer:0xD4bF46aA669856967eb41536f275B9B0dC331418:2:1463661235138196 signer:0x90056857802ebd82D930a7450c9B692eC3C475FA:3:2596340947377366 signer:0xAb1dbEF1970D9A1fe4d60fa5e10aABB5d69336d7:52:70557674643757425 signer:0xAFbd354c8AC8f198206DDDfD50fD471cFac0d491:937:129 signer:0xA237cde90ECda6e8644B775233F3E7bc759A7468:1448817:26726596 signer:0x39357e3e59d82bBf65434Fa5Ae0151657AAdb7e4:46:814911260 signer:0x9692FED2A9bF984D27cEb06EC0F3e55389DC980C:16777212:492632 signer:0x9241ab95b687d1996116B796C3223D1c7d32d855:30:157422540196514442 signer:0xd29B7F741259534C7BE9958f6441733584ac9BE7:3:46289262816116 signer:0x19E98c0f2374f46Ed3F6967768901FE8AeC0e983:8:2000244 signer:0x118D8f53464f62C709088f1b6C8A749ddf241988:0:749406627977614 signer:0x9744b15199d2Bb6294dD11c522279e5b6Ffb33d0:232292:1481312270261602479 signer:0xb60780280aa553E1B4dBC118afA972Ad5195a433:540:10 signer:0x655E8bFB5ef8eb94D1A6d0a68a0220FD9570c61C:14101735:849720636395 signer:0xc3698555cD02a4617110b4549c8bca657c6d0863:40:0 signer:0xbFbE9EED1eF8114BBdb6927F0Ced12BAD7e58B67:38:2 signer:0xF77E643d52514a603231781E2fa7C4AC3644Fd7a:641498:291227291999617 signer:0x3Faf391e25B97d5Fe36a85f8cd506cfFe982CaA6:2:1072358430 signer:0x712Fa23F79B617CE03AbDEc0e95aC8bB1852b985:7742:139565423171129 signer:0xD472145D9930DD998Bc51B6C18a14D4104894a65:66:100952072590910 signer:0x070f146f10BF2d44741F774C985A4b8967966E7f:115249:1366024134 signer:0x9EfDc5839C45d206A2357C75881cF8d9a96FbE3A:16777212:566447963697181231 signer:0xD547D17efC3b839dFc2C088F8525DD8833694693:3464:3788 signer:0x2Cf11a23E095E62f5E72a3744a05C367001D1Ea3:0:272861000 signer:0x8908C5941854b73E76760A0C750fbA148C92d880:16777215:14989386126978202596 signer:0x6Dda1fD57aDdBFC24Ed03B8475725Dee0007c73a:198431:65196656271119 signer:0x515231A67D4A74901daE6e771EB05aa021c34187:2:68433571516 signer:0x98fD6109bB79540052BA94f458B980E31D18f254:32919:42919706854131982 signer:0xd80D5e167483d6269Fe9ca189cAD4C379aE7B357:1:18446744073709551615 signer:0x7fE7d2EF7EE9A406a22879A653472D546d8FB3f6:775123:24 signer:0x6cE256B4e3a74d6717B34E5409A28a44be9b7397:5827:82137947249681 signer:0xEEB5448b99BaB260cd7845AA6e59B324c2816EC3:1124:758 signer:0xFbb86880CB9a92b3E93252a9186c310d3199aD78:4613279:9156517298527857 signer:0x890EA791de88ab640Ec7d148CC7e6f6bEfdba379:97:34046035 signer:0xEB090c7f8d9D08Fd794A9d2f97d277F06316dc02:1:5352411170408 signer:0xEF4e6681142c4729667558965b16b1f881Ebd09c:135046:783951936287971054 signer:0xE534d5E23eF138559759Bb91D35E994D76780d7B:3779349:2698067 signer:0x58558bb6e8E96287B078b8670dc9AF17B31763c6:11887:3658 signer:0x0F89f2bb8d7074A71287b338544531f43f51df4a:1:105996 signer:0xEE85f14A358E30abaB14804c333FDDE192d9A966:3179:14443691753721874 signer:0x23fc72E9b890Eef939B9DF2582175D2ca9a869e1:5:3 signer:0x05506c913F065f07faE17c8CA2720b611AAC5f67:3:160 signer:0x87630Dd345582Efb5A515EbE85F52466Eecb3728:235:8032471772 signer:0x80F161276707D241Ff4b0061D080932c8d5a5b58:1:95457 signer:0xd46c6b789034b14051ff274E0dFE6c3092D83912:8:2093905966194704 signer:0xEeC807cC1a92f614fC74F6EcfE933763763E51C7:13611019:18446744073709551615 signer:0xf42e2Ca718575702354F7905C551dA173cE1fE91:0:11753894 signer:0x477886F20C046DFd09132EAF290B41bf49F3a0C3:1289285:12455815592786596 signer:0x83C632b57C8d995d2e990681d351bb7f6cC4bB5B:609722:51344815746578 signer:0x176161d07bF44cD03dBbF1519378B0F051562C6C:22:263560129332 signer:0xc71e10369845E70aCEED2B6D37f5834B43150CfA:271:505192857550346 signer:0x2116087B4BfC5239f1c333DCc01EFc7615945bC6:1623:117378044821983208 signer:0xe364bFA5eb497104be10f85887A84Ae8F78d431f:216422:120921248994526 signer:0xDDD051A78dCC8245462F39f99BdD097a60AD6277:1792602:43296 signer:0x77260f3C7dC89288029e48d4A31f7bF0180eDddf:3:1722029154 signer:0x6780559f62fF40908b9BC0C16A6fCb25d821F6D0:2116694:605555894600158906 signer:0x2DcBEBFE7a2f5eDDde44039F1A71215017AA006f:13317:9249477786342 signer:0x7CAEc46a36df8453dDF690237F850555c7Afd4b3:478:736106955670710477 signer:0x43Aa00fB8478c76e36a20d3d6d9b2E1e5a65A275:1460730:3388959012130318 signer:0xD09eF005684CD0C47be9b6cF4583439eA527ADeB:381442:3390 signer:0xBB0322a142a6514F43F3deC1600348739965979d:8389:153889248517 signer:0x0A63ae4b57723e65CD8C88D0aC9EE93Ef22c9E6D:14178:1564129427151885 signer:0x1734bB457f33966c418E8a9030fca185CF59c58a:4:7964132262140059 signer:0xaC4e961edC85dF7Ff09fD50903E7221960452750:271:207556 signer:0xD15Fe6B02dab204E381469522C7db05DeDDB43f2:23562:272222956364778943 signer:0x772d88d3314709e724a8029545D199b0A50DbC27:0:152094957588 signer:0x406a097f9a634F10643E3A1450C5CD49B329C66D:6372:0 signer:0xaB0AC254908f666D1D90f224e532a9EaF8f66870:163842:18446744073709551614 signer:0xe9559DD04794d13c7e07E43df69D4Db883B1C537:16777213:305 signer:0x5D13f418660b6B51B599ECBf2f7f8d8c3B787404:24:84540930603630661 signer:0x27D7D4640d96Ea3d5e723DEE6921726C0068973A:323465:18446744073709551615 signer:0x38d3053a5fC992D35b19A76ff0302c4A35737572:193:38821715946712251 signer:0x9DbdbAf1033C3b6747dF83e66f5e4190CceF2614:977067:98260 signer:0xB59d1A32C043F86b8E7dEC9f809dcdC524FA926A:8764:880918")]
        public void EncodeLeaves(string input)
        {
            var leaves = input.Split(' ').Select(RecoveryLeaf.FromInput).ToArray();
            var topology = RecoveryTopology.FromLeaves(leaves);
            
            Debug.Log($"Parsed Recovery Topology: {JsonConvert.SerializeObject(topology.ToJsonObject())}");
            
            var encoded = topology.Encode();
            var decoded = RecoveryTopology.Decode(encoded);
            
            Debug.Log($"Decoded Recovery Topology: {JsonConvert.SerializeObject(decoded.ToJsonObject())}");
            Debug.Log($"Decoded Hash {decoded.Hash(true)}");
            
            Assert.AreEqual(topology.Hash(true), decoded.Hash(true));
        }

        [TestCase("0x9b7C28877079C25Da39861B2522D4B563DcE99c8", "signer:0x7BD10A32127B30C9C210624bCc51dA06154933C0:48:456176938984990 signer:0x6D3AFE787dbB560497AA2fb64c815053120F6592:1618:1 signer:0x8e2845c582C28019ee731AB3B64b926b5914B559:11557:43 signer:0x3C97CEBD4259b6b3F7a7f48CbA4424385A2db03e:1:3179150218827936 signer:0x435cc57f51F2E245613C9f67c369BF26169590F8:902515:11254 signer:0x0fBaa101eEbf22f21bcD574d647d3D3cA4CF891F:1547238:16545018 signer:0x4fFAc66d69aF850701Fa7064A088EEf72FbA3e9f:24:1163852442747889602 signer:0x125AE7200625e09fd88b3E0aF01af793E5471000:58382:797534266060 signer:0x4F83FDC640fABd78257572a793C52a94be041501:2752:329869238830 signer:0xc40790343A2C674642d4AeBC3E6e8F44e25b7013:0:914740589480730791 signer:0x06c43371D3b22Fd8229b10793F2EC22a3653cEA4:1682:8053220044614781 signer:0x8C8C476301a060D3784945E80cEBFC2043FA5073:463:6853723708471 signer:0xCCe11b69cA6187fc461e280119971aF5bb2Ea7C2:365573:0 signer:0x71f584869a7Cb50f2D1Fef611B489C512109073F:52:18446744073709551614 signer:0x58f515DCbf5a67b4fd64477a855ee7F14Ce1DeE2:3:135378691608704 signer:0xEE65f797dF79c629dB7842507a09EB568498C64C:367:12470581300064 signer:0x80FAf3Db483630796Cbf5C2461E982a215D1068d:63027:6 signer:0x3D5CAa1cA0f5AcD45bAF75cBe81fB5c4B5CB006D:0:7231 signer:0xC59C47dbE91E3127C3559e8696f8e12e2dC85892:2:28582 signer:0xf926E75cc78A74AC446433D5C79Ba716c603c341:16777215:0 signer:0x56Cb6CDE692cBA1c312398725AdB82d134b30583:1:271392378964406210 signer:0x2B898d323747a27d4B12Bb3081556E317f5Efb84:1:77443523 signer:0x99D13C8eD047eCFaBD8668dd9481EdBD0ADB8925:353581:2747 signer:0x3dF1fb6e3dbF1ed26681E058C993412CFa95a5b4:2:0 signer:0x74368ee0BA593bF69705F72F852c8e6e7A1F0Cbd:11184057:912 signer:0x85962BF2706B175febd28b1Ad1D288142c0cb646:3242:18446744073709551614 signer:0xDd48B4Db7cd5991032aD9CFCBff62Cf0058f868B:6372:8148764 signer:0x4C6B6D14306A0677e940eE95ABb546475997415c:4599:3 signer:0xdafC3Bc7b3274eD42D1D7d80728cE59DE8098247:3:27544 signer:0x8827EEdCc65888c42a38413E236D1518e323c46E:43546:2575791 signer:0x091dAfF8B797b3e43F5E7e86cC0f7efB49dF95eC:1234278:341389757821822 signer:0xF0238146DE4a17Dc2dFF7348F0F31B2693079951:66:1424 signer:0x5930c05F6CdBB5205116E444626F0FE2eEEfB905:17:33965652 signer:0x2DF27A5dDA32F2294e677DecB22641C485f627DC:2305:835214580758946 signer:0x41475c7b45424E235480Cadb2a743129910Ee741:512976:14451 signer:0x2E468Ea31ec92d28b87df506183A3aEf2E3E709a:48:26159711643975 signer:0xccEFb4d6f9cdaAd09233c93f0CC2Cb371c975976:3558529:869050901926035848 signer:0xf6Ada8248487dc2a6AEbec74cCcd039a1abF3cE1:1573307:1655456 signer:0x7ab25eBb6fcb97b34E930b55A5Dd78e587BF3B70:7154:17601 signer:0xFCEb3B1F526C4c1C7500e7381C9CB8DB70ED8917:0:13649 signer:0x797531d65784BEDE9fd9C04a613EDcE138834f23:6:2896568075565 signer:0x3Bd86875b140BfD357F1d741DFf9463a8cb35b18:16777215:3 signer:0xFb1C18b3248E329be7e179777BDa8d1fc3c9901D:47663:78 signer:0xdB401843857989fc3aA5d545D910Aa1AC194b5f9:7552:715868042 signer:0x9D2A78E1f440d5F987db7Db4de2574A051a9a644:14:8399332644078012 signer:0xEfdAca7D56981423C5C391C483A8F3F6FCea92e3:1730999:2697640428 signer:0xDcDF69216DF2e198B1f3E637449081ed26E42b6d:1:18110194118766 signer:0xa5882E764451f4273F30cd1Bf97fA7a93036752A:3:22349634430978259 signer:0xacf82b1763970B03C2034A70F1A4af5F65ab3C34:738949:3971392880166916889 signer:0xc7faBb0BB2f7e1413762c78AA4B57730c9d03c9d:3:18779264711584805 signer:0x08d34448fD4FDb559471dcaD6bb9828CA9FF1Ee8:16777214:1669 signer:0xaFa52E29DE9F2892304dc796a8436a7a5577d5F2:0:180912 signer:0xE71169eCCf170e43cdC3b7Bf13876062979301F9:37375:80270649923569 signer:0xe0400CDed288d7d313b3b00FBD14723BbFA5c051:0:2074330 signer:0x94b0c4AE6130755E64683BD10468bDBCeA9EdEE6:0:59486 signer:0xE9ca618174495039D6a36A3C4A3982A4001D69E6:12776031:415119 signer:0x8bED3699faafeE86CA559C2580F0025659aC29fD:2573:320599000794 signer:0x45010eEA7F0FaEFD2DBfc46be189d2947A93DD7A:1:1939653609210269 signer:0xB986f8dC39ddE81eeb6F13590D31f2A5Ded3cAf5:1899563:143221 signer:0x3de0A73DB4c1377Bdb0f12A80E48B81bF370eA1a:16777215:227454936348 signer:0x1D587576A70da715A3853B1e34338123543aa19d:27313:27975665 signer:0xAC3eA3BD25Df6E66842dbBa04B2E748E27087355:3:6190228209874 signer:0xfD7992d235DD3C96fEa130F978e1FdA4Fed9f2f7:6:17266164279883853 signer:0x108B5D6Eae0e0feA98703AB4a0039734D0E52557:16777212:8281 signer:0xD9C1b0e34acc2E6056eB08C3C790B835dE0E7c6C:114:0 signer:0x3AEBed7818C844A629FA50DAec3d9502Eb59adb5:1:2 signer:0xac162f233dAbEe166d629C84D89303A216232b22:202:308695370 signer:0x80EDf5651Bf1845aED2977Ba1bEa83382BDc9F27:0:3696 signer:0x04707E159C913DECb33fb38A9dC697f6CcAfd48d:16777212:2976426612126909775 signer:0xe903139889C7Bdc23823a33Fb9C9e31DF6443E58:1039579:11 signer:0xcd80b9Ec55477b9BF23B88ce17C4EDe45860d350:34:1162535825191908 signer:0xb1b36190b324a2482C663f10Dea21f1621250C15:292:254031 signer:0x0EB9D5a87692A40B2d787C60318700d1f167EC87:52:18446744073709551613 signer:0xad01A4A8Ba22d4bf4f3CFB2Df5bF80Af294e3F63:242148:93128 signer:0xeefC7e3c23f16dc46a39D961C49B96ffCE2D3c95:3898121:8379418 signer:0xF4903a87bcb2717F7338969959C4c40cccf0EA72:1089241:4731647769643279898 signer:0xf25483f192235a55F894C403C207Fbad4896B8a7:0:987173251605911958 signer:0x97C09b3011f4620e6A488529fFC1fbba478FbfE0:3:808296073 signer:0x9686486d5f817Ce47C959d018Ef3C21a8D6f9886:2698:3591582 signer:0x4929e364adBeE0Fcd86C7064195DFAC64B852B9c:6656345:249 signer:0x51feb77526f5B0fA0155Ac370cbBd93d7B98d86b:23121:197917 signer:0x0f3362Bec973A36b8ad23C208aA7f82b1d9975c8:2795:1439753454897447 signer:0xe296a3feaa66a350f5B42Eb7f968b863174af977:99:0 signer:0xb1A342F72a4181e2432DC5f2C1D6Ef4f747Db26f:232:747815 signer:0x6149EE967825766dbA4138AcB87B0196034d1197:14542:18446744073709551614 signer:0xf832A7b261Ff7D4b799118EDE2e45458746Fe7b5:637326:36898985787636988 signer:0x45471Ca280D26e423a0bc8293C10659236887F73:810:126322468 signer:0xa84DC826dbbecC4D6Bee574D788522cdE29528a3:4:3768268 signer:0xEAD633eb05BfD56D2cDc0cAd6E28A9f8511880E0:9584747:1015434355926752872 signer:0xca2Da1b4022017dFCd18e306B0E6f09f8e9AF46E:4483:781594 signer:0x5cC9F8da23abb82C60CF4b08b99A0AD48AD499FB:3:57142642 signer:0x6A5bd4A6E0ba8b1c0a6CCBf1774D382B37649A89:55085:1145 signer:0x3bDA9Fb5470F0c2bC4708bD2Cf01A02CaDA23665:221528:9243 signer:0xC5e2018b082b1C136535b529FC209d121AAE253c:450771:2561891276255 signer:0x09e7f56bB29bDCB403Ad82Ad431a4c06796AD637:991203:16683 signer:0x0359964382eaD031F90B61ab83E1815b8eEEf719:178:201 signer:0x660721293456C0d4B7a93a8F4Bac04141C8Da24B:16777212:127813613318768519 signer:0x4aa6B7E4D2B5996e8e8A1630D60fF839adBc4137:5853:1780153030 signer:0x1bAA5FBe550Bf83206528CB29f1C29B6DE5DCE1D:425486:33882343753423 signer:0x91798B32f5580EfB6b74782197e65240608Ab7F2:3978620:1050682510891 signer:0x39a0009EebeE9Fa182A6F9F4BBb31f4f5aC5C2D2:1293:41420179432 signer:0x44c5ce1622c7ecb8A6Ece946c76319c121F5b137:38746:1044548079703979060 signer:0x7E202d11dFbFd15B73D9e678beD10BC1AF60F6A4:16777212:3099452 signer:0x578943Aa4344395095B4c67D991D32831B915980:1433005:632293006183 signer:0xD1EE5bce6B5188471e180fB61E36AeAb6aEcf8f7:480646:18340493420256269 signer:0x36ef08F6728911D64a7683399747949300e9989b:5:58862779170344738 signer:0x6CEC75281Cee1A1150BC3C938ca376886Cf71Ce7:1178542:3 signer:0x722c340bC32bFff42492AFC77d68BA614F6dA881:158740:309567498 signer:0xaF9D69924A76b7750dc451FF0588771c730E17b0:0:8350304576 signer:0xfFe89d1a8889Ed95364C9FaEBCCE25C00b6BE231:7448216:1580672006 signer:0xD549FAC71947dd880fbf174C8ECaa999cFC59bfd:2071:300087703545735 signer:0x29875Bc901Fac236Fe39760324967dcF33Cd41f3:0:840277415794 signer:0xead9Ef2182fD4c14E0bE52c87dD47378A5b9DdA8:0:6701495309801 signer:0xD09aA4dd5f92dbF177d691Bd9520fE270589B8Cf:514:18446744073709551612 signer:0x98B8b3CC386eEcaeF62F54C8f05362A890238c4e:0:2102143450 signer:0x0684CCE5c50790B7e207786CbeDDbe7a0ebe9972:87125:3192540782695568 signer:0x93D69005cA68E4459eD1b3C752eBaFA3eEeaAA49:258266:10805392 signer:0x3677fE4056cBf541B87c4875bCc2590aA58E6288:11:88755129644340 signer:0xdcF5521C434D27c7Af056A03804ED450cFdd1d33:1924058:961988605085927878 signer:0x775acd6D965fEEebDa89682402fdbbD48C4f4238:271:18446744073709551612 signer:0x70c8096b04C5a2Dc1eBF74d39b27ac292a7CE29D:29186:0 signer:0x8D7F4E6AB13b06009D8b939000EefAeF5430C51c:37504:7643579 signer:0x66C5691aFCc4BF1ee4667D0F9Ee0bca52E925eF4:21453:137032 signer:0x33F7595b936733bC3D6eAB3C0A250ea38ad12f70:269:103571725 signer:0xb039FED5a40D2E2421d92B201c6cd794E2CA3610:31562:522849235 signer:0x751387BB2a9a3eF8BeA44BD0BCf5B46F861f9E07:214:41772708931071 signer:0xF795cb64EdD5d0eF498F00b8f8d4a479A47276c8:7:1 signer:0xfaec4D0b4B821B286E2Ed0BEb1660eDF8C358958:16480271:191955281236663 signer:0x9898E4373Edddbe42D49128D505165ea6D1a64fa:352934:2423189687 signer:0x8fA7570b334CABA287eb4d64Be338CB84c394EC2:1819712:36109358403 signer:0xe4df259d4F9971b2750479c2174B4aef4cE5D434:125:1350763526877317 signer:0xCA12fFd55eD4A18546Bb395Fa93a2c4f04A987cB:835374:1 signer:0xe4c7Caf9d420D6d33250B5A5B19789B0cC016DD8:45861:4174169581595778 signer:0x00010e342bb541E117D27C222BD7474A2fB29338:106240:0 signer:0x36eb446A08ef76aB70522aBD12C6F78602c7A560:15:3947523806 signer:0xE55be3C22E3981D30F56E4f282f18a1AEA08c858:73094:241132975 signer:0xB84e809698A2E775076F7e831772E1C37d0bf8d5:212244:6616685070453233972 signer:0x24B28bF225080823d2e1674A21Ff14C8efE7D11E:0:3235867992606932150 signer:0xD1539488EEB6F5006CC7141FCAdF0321d68a5e4b:1854924:2051 signer:0x3805ac21c2f0026CcD3B860A719bfCF30d9e503a:73689:40337002045 signer:0x129552848bfe0C47b2ec63A2839D8B33cA630a23:10059939:103509 signer:0x2c4B827CA1a4080b6aF4dB5Aa1A062184E706951:9:545810 signer:0xd006e5f2b2B9c4D2aD09c12EEE847b33d066b375:3:75797032514399 signer:0x34aCbecC6854652982d9a5f51600F140d343b63f:59:3379694 signer:0x2FD9D3e003778819bf3c7637321c7A33B65D307d:16777212:92781483526 signer:0xd442FABb4B29330EF530ad8176ADd1C5ecd634F6:10785:79919809 signer:0xa1750AE5a172269AF50fd5A6FFa1c1BB2eaB7aA7:338:23721596 signer:0xc22260341325a2A7dE422953e0ff43FE52E9e557:42158:48576 signer:0x7cf5C6321B33B0499939DB1c447B4763DBb8Fbc0:3411:3 signer:0x2fc35cFD0A95a3c5493758c019DcebB49D9EbE42:154:334574 signer:0x4A97d82aac7C00c46c31f5c8C3ddAb7Ba27B96aC:3208372:7505 signer:0x5aaA0C2dfFEeCc744DBE78B9Dd07303f7095Dcf8:3:3 signer:0x8211EB28ccE307E7B1623BddEE90993D5452aeFf:139014:0 signer:0xbA889b245ff5f177bBd4eFC245cDA435239110f8:68980:4 signer:0x67Af28d1965A277c890f88879C4a9f06731c7f2B:16777212:5152204257 signer:0x5AC08838A2339655fD4E36910ec9EDF12e0e6981:39868:13 signer:0x90dBC39468Ba117c1f7F34e3Ad9b08D4659CE30B:0:5746178440164 signer:0x12a0759606cDe77499CFf2f7584f4a2D7c47D0d6:692:42009287355070685 signer:0x5243A5193fb90AAF0582AA4CdA10cE0A8F718b80:153310:183244451604 signer:0x8E6F18f101988933dD0AFAE21C455361f1777616:118566:2523 signer:0xA136F7ecd94870345a06bC775E87309767654Dc8:13143010:18446744073709551612 signer:0xbEbF976AFcd9E2596cC68E3D3A77a57c8EB8F0EA:228:89699020305 signer:0x35903a5BFe35f1778068e025A7c15693218c3ffE:878:4 signer:0x8402B32335DDd218B81089F29c80e265ba9583DE:16171819:20100502 signer:0x43B18463Ba9Ac136Ea06192225932d5eB93d3853:326:373231665088639621 signer:0xD5739fC23f4cEc332C8EF839b40023e20c1C88eE:1731397:8390 signer:0x8Fa6C249c49ec2aAcFeAa1BF0aA6a56b2b97493b:3242679:11 signer:0xA8465430A8c51da25b7c9b5DA5811c5296850509:1:5751661 signer:0x60D20b1C704984177C1E08D61923a34Ae2a49Aa5:1:62492540990924 signer:0x7b126b214Ed0AF7244A94779B9bE42d59590e931:0:9365548801968 signer:0xB9054aA5FBcdBFb5d857faFeA70b18967189A13e:11:18446744073709551613 signer:0xefd81d98a2AA829e16d3c29E63CC6B55B47eC425:11:80263 signer:0x6fEB19f3f46634f65298E79A3d9f379d3ad6DB4b:0:2564 signer:0x8D47fC0362E8A28A8183D3417792814a2a86c1B2:219:855808125205 signer:0x6Cb688a0027Cc2fc7Ace8aB25Da9C434FcdC71EC:25:752753042554 signer:0xf8aD39b01820F97b8CA8c9F82D590372fa7484e6:4401:1884 signer:0xEbB9C64540f4873A3D516271659D6775B9bf5895:1:765 signer:0x964D2b70B82F5ECA4Dbaa5F59852A9716F64D25D:28205:118619533296006270 signer:0xB1c5cceEedA884288e8cc2ca8E40AC4DbE430fE0:38200:108874167870 signer:0x68Ac2fa950CD6974B278d6F91D8fe3AB9F838D04:16777215:49930576140819939 signer:0x6737f2063e6c179697633692cC1716eeEce52c96:0:10264340004122584 signer:0x42d6f37A8ABd61A405F3d8620B1c60f8D82f8dc6:93551:2739626214 signer:0xf35df3537310143775D0dfA2Aa330DFF7E4c8823:1099:5230576 signer:0x322b95b502376821f88ca1D8e6C838F5577329E1:3:1 signer:0x49a24Ad28ccCA4eD3731a99365A2A32754134A8A:2545:80 signer:0xCCDac4d441358387a4Dfef7d083c96E8578df05E:0:1025632611 signer:0x75D8387c5a4722e742e2827Cf756c02C92FEc4ae:0:18446744073709551614 signer:0x56bbd423Fc8619291222e4e9109F8fcF891431c8:0:2859794868629 signer:0x8e9eca841a2E94A9811B950ad727143D1941fBEB:2:104951584167541 signer:0xBBd5C31A8B543581842eA139eA7c28F1b13f91bf:1:132514412455805 signer:0x7e6857f122de40d6895C1d191011550c2Dd3E556:853408:8298609072202685282 signer:0x1F9406dD4662c173bF6A744Ff1EF2a6Ff73296d7:1023180:30064 signer:0x768b8252d9f60539B048D15065Ec1B9acbeFD5a1:13483:28501395961953413 signer:0x6FbE03ed32de6e9B695b5420A44dbC58cD9E94d4:7316:170419763722147332 signer:0x60B412F10271fc19e27A35B91650747CBc02617C:3079:187 signer:0x261827C0Dae3841BFA6b8Da79D8FFb3787C22f6A:476:67 signer:0xCE72023081f41E851C96DfAFb6711513f5eB0f8a:647:62814991 signer:0x2FaD88020523aDCd53989129055F5f4BA46fFf4C:0:50 signer:0x5937702316e23Ee8F518261de28a3638653a4624:9332:18446744073709551613 signer:0x8aC10E7e51bcE65626b471749A14819b4c5366ad:0:0 signer:0x78fe20896A1643152d25775867fD4CDE742f5E37:37:1860258 signer:0x00454B0d4Decc2736Cc243A10453eBC5F1c052fD:95:1180477694 signer:0xa437d936B7c6E0be0a8d33a72b6013178AdF3d4A:1:117603479434 signer:0x6Dd3340D1C17ddEE6ec81B9CD1Fe268005762728:4364639:35301027003745270 signer:0x716d196EDbF7dd5043A4f42e777eD0F5f3b40F7A:57:14265135750687746 signer:0x7312a20B6a1477D67B3295B9b6E82C295d3c2635:12:1314113256448586968 signer:0x23D57AC5e3b7080E7f7d4d7C7bcfb474EE6F4395:4:7549552 signer:0x25D0DEc666eBC6342651a07936a634B8570E31A5:10009:109148514826 signer:0x2f244bD701c5cB4DbBdB17567D473d80ae6c6F05:9:203338840106940 signer:0xF49478C11d071e5dfe91bbAC4523aA9552979f13:1:74 signer:0x58d91A8903735DE9DE38B06400474b7fbD0CD43D:1716:17808 signer:0xB26459053bd80D546CCf65e0DC1ff4dA604021b9:91:825653530669 signer:0x56606E845D09e1F49723aca1AA62786d6Fd0501F:132:3 signer:0x8080606C6Ea829F7f1FF667f12aD94823c218fe9:1:5223448602 signer:0x47ac2Dc22c305CB18122C01D14Ab1f1Cd4D0F2d6:245798:3898274548892075 signer:0xcAEc0ec73Ea6C3c701F9aE82578cc93D06C49DF1:47:16193838580 signer:0xeFE69a1950b34b4439A1f000a3119B64BA46140F:1342:482586647545331 signer:0x520736ACa3ef0dfF5B6AdCC05bc817788c433de9:3:503093 signer:0xc713c1e4a347eAAFf649C26A0dc2eaD45ec3DB4e:390:118519268609346 signer:0xed2113b8c45844aAa7e3f02Ec71C631ac187e637:1082:43279517889187 signer:0x6fe93109113Ef9B540850805bb2870f414446D46:10:3127797468402457 signer:0x27F4eB63c8ADA6eb25437a6b7DAe5a0AfA2F172c:12722:18446744073709551615 signer:0x7765670e2A53658D2dAa335af54A290265696E4f:174828:12419388940262 signer:0xD97E54844fBbA30eC8d5B242c11c04390cFCae46:29274:32 signer:0x1aCECD2BEfA7BaA5c895Ce260FdD28A443D8444f:5:13820612 signer:0x9010AA0bA954999Bd258956E50B3b0bF08CB4F36:46:459650 signer:0x4855562F41fDc050A075769d572df74dD993525e:28:692 signer:0xA4ba2705b8c42262a265C4E578DA9E882474E20b:33:474819 signer:0xE87c6AE9c64FA7B5A06ef052aD49fE6a5EC14104:522448:860004 signer:0x9b7C28877079C25Da39861B2522D4B563DcE99c8:7920953:25946 signer:0xd4956C0506A193149FE58715c80549E34fa97c01:7:0 signer:0x3eF288a2a04Ea44d3A82A9CAB92Ee24e8C059056:2464599:197073204 signer:0x600cB4BbF9B40cd24E07D2F6E975e994FAF9a3b7:19:3 signer:0x77d93eb350dae84DeF8b69B6Ba4a40b96b20116E:173026:18446744073709551612 signer:0xbac5DDF4ff20b974269aa39fE66C040F9a6dF74a:16777214:13159 signer:0xCCc578B87fa48b1462e0bb9c3A384c6b859a814c:6539780:2 signer:0x0135449B740d02110CE28D020589E5F1c4238213:545:9011552561677976 signer:0xe5710F26bB51D059eC63072f4F4dEef54c1E465C:7155880:10426565642571947 signer:0xEf63D07DAA8E6B3A28e17cF8d83620AF5eD68733:17:1867940 signer:0x76f5f461c44c36311E4946971f40600b4D7f3311:9:948 signer:0x212BE268040Dbb61D540dCAC6b55e9C9aBB9708c:229251:1642817 signer:0x794cB0C76C372aee39ba561f1FF98238540c2f93:14701:2 signer:0x14D30fe32a2DA4Bb5C697894570CA79e403654AC:2977:3 signer:0x3777D783a0AfAD08d974cA4BE474bCe2F3879e99:773548:1 signer:0x72F6BDd501740F5FEB1a4D22E5D0cEeE353b66b4:6900244:220931636811 signer:0xD63482C8970581b14Bbdf06B7F4B4341384CF99e:25:10372140457 signer:0x1260471Df7A364808B563A22606727E0D3Fd06e0:2264:70274078107896 signer:0xE7ca3e1402ccCa8cD183FFf035996695B903Bfc0:436:194 signer:0x9C75622d8764753234cb7b14d1dEd1159cB4B2ad:0:60060694 signer:0xe75853860406D5d849020033776e5222f6647b60:192:3600039820582 signer:0x15Bf0eae96e98a918f4D2BC0801feFB3B6560AC8:21711:18446744073709551613 signer:0x9e4CEA98cB9Ad775024a87282FEe86560F7f25b5:1842:43879463806383 signer:0x86d1fad0F10fA4374eD976ee94D1F31378E807bA:2848472:252893 signer:0x9A04096e3D9f06d4B8EA9029fC8d38755Cf8d13E:45:207118230169326164 signer:0x71A9D5cdB0942C1D083E71875cC9E91d4345716E:243:1076602400151600 signer:0x5e564419d0d68B99029eb6D3521e3E9fcBD69519:3:45146 signer:0xEecdee4Eba0c28BfC3F0920De70793B31e6C198F:18:93 signer:0x73fCC55EC7C3FF4A84cCFB2B033fCfdb32C8d604:482:18446744073709551613 signer:0x40dD8C424201e5DB762ae02D32F8091Cf7a3E605:20149:408764337389646 signer:0x1e2e0DF7f1089BFf97Ba17453dB637e1D261F74B:225:28 signer:0x0f253652948b43FBe1Db5C91d37BB7C06113B9af:32:345926836755 signer:0x018b603f80ba2E0B4B061FBF10c8f1f6344AE497:850615:521919877838634 signer:0x5666991C59Db0EaC0EC91c8D5bE5eC067a0fE76d:3588343:132972733816630 signer:0x268610449fD627E4F5838F315FE8aadc2a217088:16777212:1213785439 signer:0x2cBF10b58f7527017DdCF6Dff0a1108f51140147:178344:722387940915864 signer:0xb09e6FBdb9f26273BAaB3d9480F403Eb3227fA4A:0:1133991 signer:0xDa4Ef6ba6Db9fADE1981c0F82A1916F65EC2BA0d:626950:9810844668337467140 signer:0xCce00dE32530e944c52622445Dd070f0f070D1A8:7192:98006 signer:0x269716844331391001a0044377f3B5931362b70c:631:190199602843099 signer:0x46441De1bcE6e05455b408E8C1986ED2B818D906:93:19421898123540 signer:0x1bf84CF2354a2D7C01c96739Eb7B48a31B1DedF5:7:1 signer:0xB49cc49E8ceDFa6b580eebF934Fc457eC9bCb612:28:21610 signer:0x14Eae77a10cb34de3418bDCCf77330E968f98b50:4402:11609 signer:0xE0cfC419e32Fa579bd3606920ddF90B082501fa8:254274:18446744073709551615 signer:0x00C47B2957a721AcBAd66b39682F83735De3d2D2:27:48492258 signer:0xAc2D477d8c0667B65563CCC7a09a8Cec07321905:549808:512652865185661 signer:0xF7e417b9bE49e8f48Caf541ce4128991c113E883:460598:43 signer:0xCe0Ef79B18d443Ffc6C73858D7474Ae8D2aec496:4393:4579 signer:0xca4862F4b54252547c6B9935FD23e816ba03B719:27842:16364473 signer:0x879d503f0aB2669f7c4E0dc4858b3Be56fc74bdc:2:450055748558 signer:0xFcc92F6DE15928eaa6b6d109f5109548fa2F91dD:1:2 signer:0xb3AC1fc7325Ea569724B418f1C60d64883c526d4:0:7396883569314039 signer:0xBED5D9Ea5fb89af9D4B16a20BB01796Cd5eC34E4:0:51297105 signer:0x3FAF806F7eE4D43567D9C1893B4E6Aa1DAbE5e9D:0:15206858530 signer:0xb6a952d281E23a4C47F68e801c5cF7EEaF803C1A:9:18446744073709551614 signer:0xC5077f42ce8FDa1D1b2bcD58d7ea145022bc3bB5:856486:6614144307466203981 signer:0x429283c321B4FdF96A3B755Adac25AC22eE71eeA:15096250:17764 signer:0x07ed0A9DF528984f39973Fd7129E14C1951C0B0d:602825:348398781042535 signer:0xBA41d99DD808F6fF591e546Ae1B1b2258F5AF5ff:3103203:196605588989675 signer:0xf4aA3C2F951E56B82d6134F6c3aF909eF756901F:0:1085859630 signer:0xD9ea97499cC4cE346b649a6d0Fcf3AE9A21cc9e0:1:219397902844 signer:0x24D3E920bA1dC55bBcB4E7728e31eA67718768eD:9233:437 signer:0x26B924042dB2005EE9040814eE02c013A8aA0055:73:9494812543185 signer:0x297Da1A9E77430D4Ec03b972185873102daE8777:230:18446744073709551613 signer:0xF6B94491B15043C23386ec1C0BfBcbeD21bC8521:14582:18446744073709551615 signer:0x43E8126AD7D913483473188a24e256E2DDE6Feb2:1444:5163444478367 signer:0xbf9241960fD38d33b3f15b35a1c112b3e67741c6:0:1380184521430552064 signer:0x0a13702bFc4c3A2C8a1eD1862b46b42F05f8a3Da:11:4 signer:0xf1073d750E123353953F439f25bE1CE7342936A6:292167:51505240132 signer:0x2e6BF62e70b9b87836BaE5bEb8b899000629eD64:0:64601 signer:0x60EB355b0Ecf6a5c135A8410C1cAD7dA800E8405:225:10 signer:0xec6B066CCd130f4AafE39cFFada2487d5229674E:1022093:493 signer:0xD768987489A4Be65A11c47808548767c2ddA1638:1:118 signer:0xd16C95db0cc369981942F542262191EfD571E9bd:3:18446744073709551613 signer:0x440265a02484f1c8f3665fe9135bf1824E948b8c:59929:14131844138981197 signer:0xC096d66E138764a47b34302eA60bc3906149D365:15:82 signer:0x692caaeC8931bDEC324C861d0239D8F4750190fB:15595:159 signer:0xaF3328eB711b3d56c52D0eBE94eE35e85fF7a362:83175:78344987572538 signer:0x26DF8e32265800746D2609bCd304CbDdCC8f10De:91375:174888886070 signer:0x698225F02aE06930878eE7f6Be9ece88292B3a76:1267:1437108")]
        public void TrimLeaves(string signer, string input)
        {
            var leaves = input.Split(' ').Select(RecoveryLeaf.FromInput).ToArray();
            var topology = RecoveryTopology.FromLeaves(leaves);

            var originalEncoded = topology.Encode().ByteArrayToHexStringWithPrefix();
            
            var trimmed = topology.Trim(new Address(signer));
            
            var trimmedEncoded = trimmed.Encode().ByteArrayToHexStringWithPrefix();
            
            Debug.Log($"Trimmed Hash: {trimmed.Hash(true)}");
            
            Assert.AreNotEqual(originalEncoded, trimmedEncoded);
        }

        [TestCase("0x03b19740b91280bb5ad3103a9d3783ce780df0922564e9951d0f5daf5c815c89e30400011b03769df43a090943f0ab9b866176744f843696973fd08927fa785dae12691eb519040000d503e5e753ddc2b7c51d7f567d33de175c0d347f8c249dc680c01bf0825dda0c6428040000b0034a2670f9e7875d39c83b55883077f9ac367ec05e642c854326dbee0fc30ea4880400008b039cbc452569313e3b108a4166f624e8b83fe510059e21e9ecbd9b2aa188dbe3df0400006603e3267a69138af073182906aefb38937b91605c6a6006e386e84a7903176d8d2504000041019b7c28877079c25da39861b2522d4b563dce99c878dd39000000000000655a0365dae119bb399e601707aca8ff23f162ab3a49434347c5c274a640782b574ba6038a5c209aef60e572f937644965d9ca0a652279b64d6e82c0d46d307267244a32")]
        public void HashEncoded(string encodedHex)
        {
            var topology = RecoveryTopology.Decode(encodedHex.HexStringToByteArray());
            Debug.Log($"Hash of encoded topology: {topology.Hash(true)}");
        }
    }
}